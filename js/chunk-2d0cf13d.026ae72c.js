(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0cf13d"],{"61d0":function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"inner-container"},[n("page-title",{attrs:{"icon-class":"swap",title:e.$t("swap.title")}}),n("div",{staticClass:"content"},[n("div",{staticClass:"bretton-card content-left-container"},[n("div",{staticClass:"content-left-inner"},[n("div",{class:["coin-choose-card","error"===e.status?"card-error":""]},[n("div",{staticClass:"flex"},[n("p",{staticClass:"font16 c-3B4554"},[e._v("FROM")]),n("span",{staticClass:"flex1"}),n("p",{staticClass:"font16 c-A5ADB8 "},[e._v(" "+e._s(e.$t("swap.walletBalance"))+":  ")]),e.userBalances?n("p",{staticClass:"font16 c-A5ADB8"},[e._v(" "+e._s(e._f("formatNumber")(e.userBalances[e.swapFromToken],4))+" ")]):e._e()]),n("div",{staticClass:"flex drop-choose"},[e.supportedSwapTokenDetails&&e.swapFromToken?n("bretton-drop-down",{attrs:{value:e.swapFromToken,options:e.supportedSwapTokenDetails},on:{onChange:e.onChangeSwapFromToken}}):e._e(),n("span",{staticClass:"flex1"}),n("van-field",{attrs:{type:"number",placeholder:"0.0","error-message":""},on:{input:e.onChangeSwapFromAmount},model:{value:e.swapFromAmount,callback:function(t){e.swapFromAmount=t},expression:"swapFromAmount"}})],1)]),n("div",{staticClass:"flex transfer-contain"},[n("div",{staticClass:"transfer flex"},[n("span",{staticClass:"cursor-pointer",on:{click:e.transfer}},[n("svg-icon",{attrs:{"icon-class":"transfer",className:"transfer-icon"}})],1)])]),n("div",{class:["coin-choose-card","error"===e.status?"card-error":""]},[n("div",{staticClass:"flex"},[n("p",{staticClass:"font16 c-3B4554"},[e._v("TO")]),n("span",{staticClass:"flex1"}),n("p",{staticClass:"font16 c-A5ADB8"},[e._v(" "+e._s(e.$t("swap.walletBalance"))+":  ")]),e.userBalances?n("p",{staticClass:"font16 c-A5ADB8"},[e._v(" "+e._s(e._f("formatNumber")(e.userBalances[e.swapToToken],4))+" ")]):e._e()]),n("div",{staticClass:"flex drop-choose"},[e.supportedSwapTokenDetails?n("bretton-drop-down",{attrs:{value:e.swapToToken,options:e.supportedSwapTokenDetails},on:{onChange:e.onChangeSwapToToken}}):e._e(),n("span",{staticClass:"flex1"}),n("van-field",{attrs:{type:"text",placeholder:"0.0","error-message":""},on:{input:e.onChangeSwapToAmount},model:{value:e.swapToAmount,callback:function(t){e.swapToAmount=t},expression:"swapToAmount"}})],1)]),n("div",{staticClass:"error-container"},[e.user&&e.userBalances&&e.liquidities&&e.errorMessage?n("div",{staticClass:"flex balance-error"},[n("svg-icon",{attrs:{"icon-class":"warning",className:"warning-icon error-icon"}}),n("p",{staticClass:"font16 c-error ml5"},[e._v(" "+e._s(e.errorMessage)+" ")])],1):e._e()]),e.user?n("div",[e.hasAllowance?n("van-button",{staticClass:"bretton-btn gradient-btn",attrs:{disabled:e.disableSwap,loading:e.isSwapping,"loading-text":e.$t("Swapping")},on:{click:function(t){return e.swap()}}},[e._v(" "+e._s(e.$t("Swap"))+" ")]):n("van-button",{staticClass:"bretton-btn gradient-btn",attrs:{loading:e.isApproving,"loading-text":e.$t("Approving")},on:{click:function(t){return e.approve()}}},[e._v(" "+e._s(e.$t("Approve"))+" ")])],1):n("div",[n("van-button",{staticClass:"bretton-btn gradient-btn",attrs:{loading:e.isConnecting,"loading-text":e.$t("Connecting")},on:{click:function(t){return e.connectWallet()}}},[e._v(" "+e._s(e.$t("ConnectWallet"))+" ")])],1)]),n("div",{staticClass:"fee-contain"},[n("div",{staticClass:"flex"},[n("label",{staticClass:"font16 bold c-3B4554"},[e._v(e._s(e.$t("swap.fee"))+"  ")]),n("van-popover",{attrs:{placement:"right"},scopedSlots:e._u([{key:"reference",fn:function(){return[n("span",{on:{mouseenter:function(t){e.showFeeTips=!0},mouseleave:function(t){e.showFeeTips=!1}}},[n("svg-icon",{attrs:{"icon-class":"information",className:"warning-icon"}})],1)]},proxy:!0}]),model:{value:e.showFeeTips,callback:function(t){e.showFeeTips=t},expression:"showFeeTips"}},[n("div",{staticClass:"tips-content"},[e._v(" "+e._s(e.$t("swap.feeTips"))+" ")])]),n("span",{staticClass:"flex1"}),n("p",{staticClass:"font16 c-A5ADB8"},[e._v(e._s(100*e.swapFee)+" % ")])],1)])]),n("div",{staticClass:"content-right-container"},[n("div",{staticClass:"bretton-card content-right-card"},[n("h3",{staticClass:"font16 c-8C5AFF bold"},[e._v(e._s(e.$t("swap.liquidity")))]),e.liquidities?n("div",e._l(e.liquidities,(function(t,s){return n("li",{key:s},[n("div",{staticClass:"flex mt20"},[n("img",{staticClass:"mr10",attrs:{src:e.getTokenImg(s),width:"24"}}),n("div",{staticClass:"font16 bold c-A5ADB8"},[e._v(e._s(s))]),n("span",{staticClass:"flex1"}),n("div",{staticClass:"font16 c-3B4554"},[e._v(e._s(e._f("formatNumber")(t,4)))])])])})),0):n("div",[n("van-loading",{staticClass:"flex mt20",attrs:{type:"spinner"}},[e._v("Loading...")])],1)]),n("div",{staticClass:"bretton-card content-right-card"},[n("h3",{staticClass:"font16 c-8C5AFF bold"},[e._v(e._s(e.$t("swap.swapVolume")))]),e.totalSwapVolume&&e.dailySwapVolume?n("div",[n("div",{staticClass:"flex mt20"},[n("div",{staticClass:"font16 bold c-A5ADB8"},[e._v(e._s(e.$t("swap.total")))]),n("span",{staticClass:"flex1"}),n("div",{staticClass:"font16 c-3B4554"},[e._v(e._s(e._f("formatNumber")(e.totalSwapVolume,4)))])]),n("div",{staticClass:"flex mt20"},[n("div",{staticClass:"font16 bold c-A5ADB8"},[e._v(e._s(e.$t("swap.daily")))]),n("span",{staticClass:"flex1"}),n("div",{staticClass:"font16 c-3B4554"},[e._v(e._s(e._f("formatNumber")(e.dailySwapVolume,4)))])])]):n("div",[n("van-loading",{staticClass:"flex mt20",attrs:{type:"spinner"}},[e._v("Loading...")])],1)]),e.user?n("div",{staticClass:"bretton-card content-right-card"},[n("h3",{staticClass:"font16 c-8C5AFF bold"},[e._v(e._s(e.$t("SwapMining")))]),e.userDetail?n("div",[n("div",{staticClass:"flex mt20"},[n("div",{staticClass:"font16 bold c-A5ADB8"},[e._v(e._s(e.$t("MyVolume")))]),n("span",{staticClass:"flex1"}),n("div",{staticClass:"font16 c-3B4554"},[e._v(e._s(e._f("formatNumber")(e.userDetail["volume"],4)))])]),n("div",{staticClass:"flex mt20"},[n("div",{staticClass:"font16 bold c-A5ADB8"},[e._v(e._s(e.$t("Rewards")))]),n("span",{staticClass:"flex1"}),n("div",{staticClass:"font16 c-3B4554"},[e._v(e._s(e._f("formatNumber")(e.userDetail["pendingRewards"],2))+" BRET")])]),n("div",{staticClass:"flex mt20"},[n("van-button",{staticClass:"bretton-btn claim-btn",attrs:{disabled:!e.hasPendingRewards,loading:e.isClaiming,"loading-text":e.$t("Claiming")},on:{click:function(t){e.showClaimDialog=!0}}},[e._v(" "+e._s(e.$t("ClaimRewards"))+" ")])],1)]):n("div",[n("van-loading",{staticClass:"flex mt20",attrs:{type:"spinner"}},[e._v("Loading...")])],1)]):e._e()])])],1),n("ClaimDialog",{attrs:{show:e.showClaimDialog},on:{"update:show":function(t){e.showClaimDialog=t},onCancel:e.onCancel,onConfirm:e.onConfirm}})],1)},a=[],i=n("b85c"),o=n("1da1"),r=n("5530"),c=(n("99af"),n("d3b7"),n("25f0"),n("d81d"),n("96cf"),n("89dd")),l=n("124b"),u=n("fc10"),p=(n("9b7c"),n("a886"),n("2f62")),w=n("73f9"),d=n("88ba"),m=n("11da"),f=n("65e2"),h=n("46eb"),v=n("901e"),g={name:"Swap",components:{PageTitle:c["a"],BrettonDropDown:l["a"],ClaimDialog:u["a"]},data:function(){return{status:"default",showFeeTips:!1,showAPYTips:!1,showClaimDialog:!1,swapFromAmount:null,swapToAmount:null,swapFromToken:null,swapToToken:null,supportedSwapTokens:null,supportedSwapTokenDetails:null,swapFee:null,swapAPY:null,totalSwapVolume:null,dailySwapVolume:null,liquidities:null,pid:1,userDetail:null,userBalances:null,userAllowances:null,isConnecting:!1,isApproving:!1,isSwapping:!1,isClaiming:!1,intervals:[]}},computed:Object(r["a"])(Object(r["a"])({},Object(p["b"])({user:function(e){return e.wallet.user},chainId:function(e){return e.wallet.chainId},isWeb3Initialized:function(e){return e.wallet.isWeb3Initialized}})),{},{hasAllowance:function(){return!(!this.userAllowances||!this.userAllowances[this.swapFromToken])&&new v["BigNumber"](this.userAllowances[this.swapFromToken]).gt(new v["BigNumber"]("1e18"))},disableSwap:function(){return!this.hasEnoughLiquidity||!this.hasEnoughBalance||!this.swapFromAmount||new v["BigNumber"](this.swapFromAmount).lte(0)},errorMessage:function(){return this.hasEnoughBalance?this.hasEnoughLiquidity?null:"not enough ".concat(this.swapToToken," liquidity in pool"):"not enough ".concat(this.swapFromToken," balance in your wallet")},hasEnoughLiquidity:function(){return!!this.liquidities&&(!this.swapFromAmount||new v["BigNumber"](this.liquidities[this.swapToToken]).gte(this.swapFromAmount))},hasEnoughBalance:function(){return!(!this.user||!this.userBalances)&&(!this.swapFromAmount||new v["BigNumber"](this.userBalances[this.swapFromToken]).gte(this.swapFromAmount))},hasPendingRewards:function(){return!!(this.userDetail&&this.userDetail["pendingRewards"]&&new v["BigNumber"](this.userDetail["pendingRewards"]).gt(0))}}),methods:{connectWallet:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isConnecting=!0,t.next=4,e.$store.dispatch("connectWallet");case 4:t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),e.$notify({type:"danger",message:t.t0.message});case 9:return t.prev=9,e.isConnecting=!1,t.finish(9);case 12:case"end":return t.stop()}}),t,null,[[0,6,9,12]])})))()},approve:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isApproving=!0,t.prev=1,t.next=4,m["a"](window.web3,e.chainId,e.swapFromToken,e.user["account"],f["a"][e.chainId]["bretUSD"]["address"],e.openTxNotification);case 4:return t.next=6,e.loadUserAllowances();case 6:e.$notify({type:"success",message:"Approve Success!"}),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),e.$notify({type:"danger",message:t.t0.message});case 12:return t.prev=12,e.isApproving=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[1,9,12,15]])})))()},swap:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isSwapping=!0,t.prev=1,t.next=4,w["h"](window.web3,e.swapFromToken,e.swapToToken,e.swapFromAmount,e.openTxNotification);case 4:e.resetInputAmounts(),e.$notify({type:"success",message:"Swap Success!"}),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),e.$notify({type:"danger",message:t.t0.message});case 11:return t.prev=11,e.isSwapping=!1,t.finish(11);case 14:e.loadUserDetail(),e.loadUserAllowances(),e.loadUserBalances(),e.loadSwapVolume(),e.loadLiquidities();case 19:case"end":return t.stop()}}),t,null,[[1,8,11,14]])})))()},loadUserDetail:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.user){t.next=4;break}return t.next=3,d["b"](window.web3,e.pid,e.user["account"]);case 3:e.userDetail=t.sent;case 4:case"end":return t.stop()}}),t)})))()},onCancel:function(){this.showClaimDialog=!1},onConfirm:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.showClaimDialog=!1,e.isClaiming=!0,t.prev=2,t.next=5,d["a"](window.web3,e.openTxNotification);case 5:e.$notify({type:"success",message:"Claim Success!"}),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](2),e.$notify({type:"danger",message:t.t0.message});case 11:return t.prev=11,e.isClaiming=!1,t.finish(11);case 14:e.loadUserDetail();case 15:case"end":return t.stop()}}),t,null,[[2,8,11,14]])})))()},resetInputAmounts:function(){this.swapFromAmount=null,this.swapToAmount=null},openTxNotification:function(e){var t="".concat(h["a"][this.chainId]["scanLink"],"/tx/").concat(e);this.$dialog.confirm({title:"Transaction Submitted",message:e,cancelButtonText:"Confirm",confirmButtonText:"View Transanction"}).then((function(){window.open(t,"_blank")})).catch((function(){}))},onChangeSwapFromToken:function(e){e.value===this.swapToToken&&(this.swapToToken=this.swapFromToken,this.swapFromToken=e.value)},onChangeSwapToToken:function(e){e.value===this.swapFromToken&&(this.swapFromToken=this.swapToToken,this.swapToToken=e.value)},onChangeSwapFromAmount:function(e){e?(this.swapFromAmount=e,this.swapToAmount=new v["BigNumber"](this.swapFromAmount).times(new v["BigNumber"](1).minus(this.swapFee)).toString(10)):this.swapToAmount=null},onChangeSwapToAmount:function(e){e?(this.newSwapToAmount=e,this.swapFromAmount=new v["BigNumber"](this.newSwapToAmount).div(new v["BigNumber"](1).minus(this.swapFee)).toString(10)):this.swapFromAmount=null},loadSwapFee:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w["d"](window.web3);case 2:e.swapFee=t.sent;case 3:case"end":return t.stop()}}),t)})))()},loadSwapVolume:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w["e"](window.web3);case 2:return e.totalSwapVolume=t.sent,t.next=5,w["a"](window.web3);case 5:e.dailySwapVolume=t.sent;case 6:case"end":return t.stop()}}),t)})))()},loadLiquidities:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w["b"](window.web3);case 2:e.liquidities=t.sent;case 3:case"end":return t.stop()}}),t)})))()},loadUserBalances:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,s,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.user){t.next=21;break}n={},s=Object(i["a"])(e.supportedSwapTokens),t.prev=3,s.s();case 5:if((a=s.n()).done){t.next=12;break}return o=a.value,t.next=9,m["e"](window.web3,e.chainId,o,e.user["account"]);case 9:n[o]=t.sent;case 10:t.next=5;break;case 12:t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](3),s.e(t.t0);case 17:return t.prev=17,s.f(),t.finish(17);case 20:e.userBalances=n;case 21:case"end":return t.stop()}}),t,null,[[3,14,17,20]])})))()},loadUserAllowances:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.user){t.next=4;break}return t.next=3,m["d"](window.web3,e.chainId,e.supportedSwapTokens,e.user["account"],f["a"][e.chainId]["bretUSD"]["address"]);case 3:e.userAllowances=t.sent;case 4:case"end":return t.stop()}}),t)})))()},getTokenImg:function(e){return n("e078")("./".concat(e,".png"))},transfer:function(){var e=this.swapFromToken;this.swapFromToken=this.swapToToken,this.swapToToken=e}},created:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("initWeb3");case 3:t.next=8;break;case 5:t.prev=5,t.t0=t["catch"](0),e.$notify({type:"danger",message:t.t0.message});case 8:return t.next=10,w["c"](window.web3);case 10:e.supportedSwapTokens=t.sent,e.swapFromToken=e.supportedSwapTokens[0],e.swapToToken=e.supportedSwapTokens[1],e.supportedSwapTokenDetails=e.supportedSwapTokens.map((function(t){return{text:t,iconUrl:e.getTokenImg(t),value:t}})),e.loadSwapVolume(),e.loadSwapFee(),e.loadLiquidities(),e.loadUserDetail(),e.loadUserBalances(),e.loadUserAllowances();case 20:case"end":return t.stop()}}),t,null,[[0,5]])})))()},mounted:function(){return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){}},b=g,C=n("2877"),T=Object(C["a"])(b,s,a,!1,null,"2c9bcc69",null);t["default"]=T.exports}}]);