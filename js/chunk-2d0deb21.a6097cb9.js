(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0deb21"],{"876b":function(n,e,t){"use strict";t.r(e);var a=function(){var n=this,e=n.$createElement,a=n._self._c||e;return a("div",[a("div",{staticClass:"inner-container"},[a("page-title",{attrs:{"icon-class":"mint",title:"Mint"}}),a("div",{staticClass:"tab-contain"},[a("van-tabs",{on:{click:n.changeTab},model:{value:n.active,callback:function(e){n.active=e},expression:"active"}},[a("van-tab",{attrs:{name:"Mint",title:n.$t("mintAndRedeem.mintTitle")}}),a("van-tab",{attrs:{name:"Redeem",title:n.$t("mintAndRedeem.redeemTitle")}})],1)],1),a("div",{staticClass:"content"},[a("div",{staticClass:"bretton-card content-left-container"},[a("div",{staticClass:"content-left-inner"},[a("div",{class:["coin-choose-card","error"===n.status?"card-error":""]},[a("div",{staticClass:"flex"},[a("p",{staticClass:"font16 c-3B4554"},[n._v("FROM")]),a("span",{staticClass:"flex1"}),a("p",{staticClass:"font16 c-A5ADB8 "},[n._v(" "+n._s(n.$t("mintAndRedeem.walletBalance"))+":  ")]),n.userBalances?a("p",{staticClass:"font16 c-A5ADB8"},[n._v(" "+n._s(n._f("formatNumber")(n.userBalances[n.mintFromToken],4))+" ")]):n._e()]),a("div",{staticClass:"flex drop-choose"},[n.supportedSwapTokenDetails&&n.mintFromToken?a("bretton-drop-down",{attrs:{value:n.mintFromToken,options:n.supportedSwapTokenDetails},on:{onChange:n.onChangeMintFromToken}}):n._e(),a("span",{staticClass:"flex1"}),a("van-field",{attrs:{type:"number",placeholder:"0.0","error-message":""},on:{input:n.onChangeMintFromAmount},model:{value:n.mintFromAmount,callback:function(e){n.mintFromAmount=e},expression:"mintFromAmount"}}),a("van-button",{staticClass:"max-btn",attrs:{disabled:!n.userBalances},on:{click:function(e){return n.onChangeMintFromAmount(n.userBalances[n.mintFromToken])}}},[n._v("MAX")])],1)]),a("div",{staticClass:"flex transfer-contain"},[a("div",{staticClass:"non-transfer flex"},[a("span",[a("svg-icon",{attrs:{"icon-class":"tansfer2",className:"transfer-icon"}})],1)])]),a("div",{class:["coin-choose-card","error"===n.status?"card-error":""]},[a("div",{staticClass:"flex"},[a("p",{staticClass:"font16 c-3B4554"},[n._v("TO")]),a("span",{staticClass:"flex1"}),a("p",{staticClass:"font16 c-A5ADB8 "},[n._v(" "+n._s(n.$t("WalletBalance"))+":  ")]),n.userBalances?a("p",{staticClass:"font16 c-A5ADB8"},[n._v(" "+n._s(n._f("formatNumber")(n.userBalances[n.mintToToken],4))+" ")]):n._e()]),a("div",{staticClass:"flex mt10 drop-display"},[a("img",{attrs:{src:t("f646"),width:"40"}}),a("div",{staticClass:"font18 c-3B4554 bold ml10"},[n._v(n._s(n.mintToToken))]),a("span",{staticClass:"flex1"}),a("van-field",{attrs:{type:"number",placeholder:"0.0"},on:{input:n.onChangeMintToAmount},model:{value:n.mintToAmount,callback:function(e){n.mintToAmount=e},expression:"mintToAmount"}})],1)]),a("div",{staticClass:"error-container"},[n.user&&n.userBalances&&n.errorMessage?a("div",{staticClass:"flex balance-error"},[a("svg-icon",{attrs:{"icon-class":"warning",className:"warning-icon error-icon"}}),a("p",{staticClass:"font16 c-error ml5"},[n._v(" "+n._s(n.errorMessage)+" ")])],1):n._e()]),n.user?a("div",[n.hasAllowance?a("van-button",{staticClass:"bretton-btn gradient-btn",attrs:{disabled:n.disableMint,loading:n.isMinting,"loading-text":n.$t("Minting")},on:{click:function(e){return n.mint()}}},[n._v(" "+n._s(n.$t("Mint"))+" ")]):a("van-button",{staticClass:"bretton-btn gradient-btn",attrs:{loading:n.isApproving,"loading-text":n.$t("Approving")},on:{click:function(e){return n.approve()}}},[n._v(" "+n._s(n.$t("Approve"))+" ")])],1):a("div",[a("van-button",{staticClass:"bretton-btn gradient-btn",attrs:{loading:n.isConnecting,"loading-text":n.$t("Connecting")},on:{click:function(e){return n.connectWallet()}}},[n._v(" "+n._s(n.$t("ConnectWallet"))+" ")])],1)])])])],1)])},s=[],r=t("b85c"),i=t("1da1"),o=t("5530"),c=(t("99af"),t("d81d"),t("96cf"),t("89dd")),u=t("124b"),l=(t("9b7c"),t("a886"),t("2f62")),m=t("73f9"),d=t("11da"),p=t("65e2"),f=t("46eb"),h=t("901e"),v={name:"Mint",components:{PageTitle:c["a"],BrettonDropDown:u["a"]},data:function(){return{active:"Mint",status:"default",mintFromToken:null,mintToToken:"bretUSD",mintFromAmount:null,mintToAmount:null,supportedSwapTokens:null,supportedSwapTokenDetails:null,userBalances:null,userAllowances:null,isConnecting:!1,isApproving:!1,isMinting:!1,intervals:[]}},computed:Object(o["a"])(Object(o["a"])({},Object(l["b"])({user:function(n){return n.wallet.user},chainId:function(n){return n.wallet.chainId},isWeb3Initialized:function(n){return n.wallet.isWeb3Initialized}})),{},{hasAllowance:function(){return!(!this.userAllowances||!this.userAllowances[this.mintFromToken])&&new h["BigNumber"](this.userAllowances[this.mintFromToken]).gt(new h["BigNumber"]("1e18"))},disableMint:function(){return!this.hasEnoughBalance||!this.mintFromAmount||new h["BigNumber"](this.mintFromAmount).lte(0)},errorMessage:function(){return this.hasEnoughBalance?null:"not enough ".concat(this.mintFromToken," balance in your wallet")},hasEnoughBalance:function(){return!(!this.user||!this.userBalances)&&(!this.mintFromAmount||new h["BigNumber"](this.userBalances[this.mintFromToken]).gte(this.mintFromAmount))}}),methods:{onChangeMintFromToken:function(n){this.mintFromToken=n.value},onChangeMintFromAmount:function(n){this.mintFromAmount=n,this.mintToAmount=n},onChangeMintToAmount:function(n){this.mintFromAmount=n,this.mintToAmount=n},connectWallet:function(){var n=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,n.isConnecting=!0,e.next=4,n.$store.dispatch("connectWallet");case 4:e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),n.$notify({type:"danger",message:e.t0.message});case 9:return e.prev=9,n.isConnecting=!1,e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[0,6,9,12]])})))()},approve:function(){var n=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n.isApproving=!0,e.prev=1,e.next=4,d["a"](window.web3,n.chainId,n.mintFromToken,n.user["account"],p["a"][n.chainId]["bretUSD"]["address"],n.openTxNotification);case 4:return e.next=6,n.loadUserAllowances();case 6:n.$notify({type:"success",message:"Approve Success!"}),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),n.$notify({type:"danger",message:e.t0.message});case 12:return e.prev=12,n.isApproving=!1,e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])})))()},mint:function(){var n=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n.isMinting=!0,e.prev=1,e.next=4,m["f"](window.web3,n.mintFromToken,n.mintFromAmount,n.openTxNotification);case 4:n.resetInputAmounts(),n.$notify({type:"success",message:"Mint Success!"}),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),n.$notify({type:"danger",message:e.t0.message});case 11:return e.prev=11,n.isMinting=!1,e.finish(11);case 14:n.loadUserAllowances(),n.loadUserBalances();case 16:case"end":return e.stop()}}),e,null,[[1,8,11,14]])})))()},resetInputAmounts:function(){this.mintFromAmount=null,this.mintToAmount=null},openTxNotification:function(n){var e="".concat(f["a"][this.chainId]["scanLink"],"/tx/").concat(n);this.$dialog.confirm({title:"Transaction Submitted",message:n,cancelButtonText:"Confirm",confirmButtonText:"View Transanction"}).then((function(){window.open(e,"_blank")})).catch((function(){}))},changeTab:function(n,e){"Redeem"===e&&this.$router.push({name:"Redeem"})},getTokenImg:function(n){try{return t("e078")("./".concat(n,".png"))}catch(e){console.warn("can not find token image for ".concat(n))}return t("0d9c")},loadUserBalances:function(){var n=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!n.user){e.next=21;break}t={},a=Object(r["a"])(n.supportedSwapTokens.concat(["bretUSD"])),e.prev=3,a.s();case 5:if((s=a.n()).done){e.next=12;break}return i=s.value,e.next=9,d["e"](window.web3,n.chainId,i,n.user["account"]);case 9:t[i]=e.sent;case 10:e.next=5;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](3),a.e(e.t0);case 17:return e.prev=17,a.f(),e.finish(17);case 20:n.userBalances=t;case 21:case"end":return e.stop()}}),e,null,[[3,14,17,20]])})))()},loadUserAllowances:function(){var n=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!n.user){e.next=4;break}return e.next=3,d["d"](window.web3,n.chainId,n.supportedSwapTokens,n.user["account"],p["a"][n.chainId]["bretUSD"]["address"]);case 3:n.userAllowances=e.sent;case 4:case"end":return e.stop()}}),e)})))()}},created:function(){var n=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.$store.dispatch("initWeb3");case 3:e.next=8;break;case 5:e.prev=5,e.t0=e["catch"](0),n.$notify({type:"danger",message:e.t0.message});case 8:return e.next=10,m["c"](window.web3);case 10:n.supportedSwapTokens=e.sent,n.mintFromToken=n.supportedSwapTokens[0],n.supportedSwapTokenDetails=n.supportedSwapTokens.map((function(e){return{text:e,iconUrl:n.getTokenImg(e),value:e}})),n.loadUserBalances(),n.loadUserAllowances(),n.intervals.push(setInterval(n.loadUserBalances,1e4));case 16:case"end":return e.stop()}}),e,null,[[0,5]])})))()},mounted:function(){return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:case"end":return n.stop()}}),n)})))()},beforeDestroy:function(){var n,e=Object(r["a"])(this.intervals);try{for(e.s();!(n=e.n()).done;){var t=n.value;clearInterval(t)}}catch(a){e.e(a)}finally{e.f()}}},g=v,b=t("2877"),w=Object(b["a"])(g,a,s,!1,null,"117033f4",null);e["default"]=w.exports}}]);