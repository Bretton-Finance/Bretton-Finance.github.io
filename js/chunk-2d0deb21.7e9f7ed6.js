(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0deb21"],{"876b":function(e,n,t){"use strict";t.r(n);var a=function(){var e=this,n=e.$createElement,a=e._self._c||n;return a("div",[a("div",{staticClass:"inner-container"},[a("page-title",{attrs:{"icon-class":"mint",title:"Mint"}}),a("div",{staticClass:"tab-contain"},[a("van-tabs",{on:{click:e.changeTab},model:{value:e.active,callback:function(n){e.active=n},expression:"active"}},[a("van-tab",{attrs:{name:"Mint",title:e.$t("mintAndRedeem.mintTitle")}}),a("van-tab",{attrs:{name:"Redeem",title:e.$t("mintAndRedeem.redeemTitle")}})],1)],1),a("div",{staticClass:"content"},[a("div",{staticClass:"bretton-card content-left-container"},[a("div",{staticClass:"content-left-inner"},[a("div",{class:["coin-choose-card","error"===e.status?"card-error":""]},[a("div",{staticClass:"flex"},[a("p",{staticClass:"font16 c-3B4554"},[e._v("FROM")]),a("span",{staticClass:"flex1"}),a("p",{staticClass:"font16 c-A5ADB8 "},[e._v(" "+e._s(e.$t("mintAndRedeem.walletBalance"))+":  ")]),e.userBalances?a("p",{staticClass:"font16 c-A5ADB8"},[e._v(" "+e._s(e._f("formatNumber")(e.userBalances[e.mintFromToken],4))+" ")]):e._e()]),a("div",{staticClass:"flex drop-choose"},[e.supportedSwapTokenDetails&&e.mintFromToken?a("bretton-drop-down",{attrs:{value:e.mintFromToken,options:e.supportedSwapTokenDetails},on:{onChange:e.onChangeMintFromToken}}):e._e(),a("span",{staticClass:"flex1"}),a("van-field",{attrs:{type:"number",placeholder:"0.0","error-message":""},on:{input:e.onChangeMintFromAmount},model:{value:e.mintFromAmount,callback:function(n){e.mintFromAmount=n},expression:"mintFromAmount"}})],1)]),a("div",{staticClass:"flex transfer-contain"},[a("div",{staticClass:"transfer flex"},[a("span",[a("svg-icon",{attrs:{"icon-class":"tansfer2",className:"transfer-icon"}})],1)])]),a("div",{class:["coin-choose-card","error"===e.status?"card-error":""]},[a("div",{staticClass:"flex"},[a("p",{staticClass:"font16 c-3B4554"},[e._v("TO")]),a("span",{staticClass:"flex1"}),a("p",{staticClass:"font16 c-A5ADB8 "},[e._v(" "+e._s(e.$t("WalletBalance"))+":  ")]),e.userBalances?a("p",{staticClass:"font16 c-A5ADB8"},[e._v(" "+e._s(e._f("formatNumber")(e.userBalances[e.mintToToken],4))+" ")]):e._e()]),a("div",{staticClass:"flex mt10 drop-display"},[a("img",{attrs:{src:t("f646"),width:"40"}}),a("div",{staticClass:"font18 c-3B4554 bold ml10"},[e._v(e._s(e.mintToToken))]),a("span",{staticClass:"flex1"}),a("van-field",{attrs:{type:"number",placeholder:"0.0"},on:{input:e.onChangeMintToAmount},model:{value:e.mintToAmount,callback:function(n){e.mintToAmount=n},expression:"mintToAmount"}})],1)]),a("div",{staticClass:"error-container"},[e.user&&e.userBalances&&e.errorMessage?a("div",{staticClass:"flex balance-error"},[a("svg-icon",{attrs:{"icon-class":"warning",className:"warning-icon error-icon"}}),a("p",{staticClass:"font16 c-error ml5"},[e._v(" "+e._s(e.errorMessage)+" ")])],1):e._e()]),e.user?a("div",[e.hasAllowance?a("van-button",{staticClass:"bretton-btn gradient-btn",attrs:{disabled:e.disableMint,loading:e.isMinting,"loading-text":e.$t("Minting")},on:{click:function(n){return e.mint()}}},[e._v(" "+e._s(e.$t("Mint"))+" ")]):a("van-button",{staticClass:"bretton-btn gradient-btn",attrs:{loading:e.isApproving,"loading-text":e.$t("Approving")},on:{click:function(n){return e.approve()}}},[e._v(" "+e._s(e.$t("Approve"))+" ")])],1):a("div",[a("van-button",{staticClass:"bretton-btn gradient-btn",attrs:{loading:e.isConnecting,"loading-text":e.$t("Connecting")},on:{click:function(n){return e.connectWallet()}}},[e._v(" "+e._s(e.$t("ConnectWallet"))+" ")])],1)])])])],1)])},s=[],r=t("b85c"),i=t("1da1"),o=t("5530"),c=(t("99af"),t("d81d"),t("96cf"),t("89dd")),u=t("124b"),l=(t("9b7c"),t("a886"),t("2f62")),m=t("73f9"),d=t("11da"),p=t("65e2"),f=t("46eb"),h=t("901e"),v={name:"Mint",components:{PageTitle:c["a"],BrettonDropDown:u["a"]},data:function(){return{active:"Mint",status:"default",mintFromToken:null,mintToToken:"bretUSD",mintFromAmount:null,mintToAmount:null,supportedSwapTokens:null,supportedSwapTokenDetails:null,userBalances:null,userAllowances:null,isConnecting:!1,isApproving:!1,isMinting:!1,intervals:[]}},computed:Object(o["a"])(Object(o["a"])({},Object(l["b"])({user:function(e){return e.wallet.user},chainId:function(e){return e.wallet.chainId},isWeb3Initialized:function(e){return e.wallet.isWeb3Initialized}})),{},{hasAllowance:function(){return!(!this.userAllowances||!this.userAllowances[this.mintFromToken])&&new h["BigNumber"](this.userAllowances[this.mintFromToken]).gt(new h["BigNumber"]("1e18"))},disableMint:function(){return!this.hasEnoughBalance||!this.mintFromAmount||new h["BigNumber"](this.mintFromAmount).lte(0)},errorMessage:function(){return this.hasEnoughBalance?null:"not enough ".concat(this.mintFromToken," balance in your wallet")},hasEnoughBalance:function(){return!(!this.user||!this.userBalances)&&(!this.mintFromAmount||new h["BigNumber"](this.userBalances[this.mintFromToken]).gte(this.mintFromAmount))}}),methods:{onChangeMintFromToken:function(e){this.mintFromToken=e.value},onChangeMintFromAmount:function(e){this.mintFromAmount=e,this.mintToAmount=e},onChangeMintToAmount:function(e){this.mintFromAmount=e,this.mintToAmount=e},connectWallet:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,e.isConnecting=!0,n.next=4,e.$store.dispatch("connectWallet");case 4:n.next=9;break;case 6:n.prev=6,n.t0=n["catch"](0),e.$notify({type:"danger",message:n.t0.message});case 9:return n.prev=9,e.isConnecting=!1,n.finish(9);case 12:case"end":return n.stop()}}),n,null,[[0,6,9,12]])})))()},approve:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.isApproving=!0,n.prev=1,n.next=4,d["a"](window.web3,e.chainId,e.mintFromToken,e.user["account"],p["a"][e.chainId]["bretUSD"]["address"],e.openTxNotification);case 4:return n.next=6,e.loadUserAllowances();case 6:e.$notify({type:"success",message:"Approve Success!"}),n.next=12;break;case 9:n.prev=9,n.t0=n["catch"](1),e.$notify({type:"danger",message:n.t0.message});case 12:return n.prev=12,e.isApproving=!1,n.finish(12);case 15:case"end":return n.stop()}}),n,null,[[1,9,12,15]])})))()},mint:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.isMinting=!0,n.prev=1,n.next=4,m["f"](window.web3,e.mintFromToken,e.mintFromAmount,e.openTxNotification);case 4:e.resetInputAmounts(),e.$notify({type:"success",message:"Mint Success!"}),n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](1),e.$notify({type:"danger",message:n.t0.message});case 11:return n.prev=11,e.isMinting=!1,n.finish(11);case 14:e.loadUserAllowances(),e.loadUserBalances();case 16:case"end":return n.stop()}}),n,null,[[1,8,11,14]])})))()},resetInputAmounts:function(){this.mintFromAmount=null,this.mintToAmount=null},openTxNotification:function(e){var n="".concat(f["a"][this.chainId]["scanLink"],"/tx/").concat(e);this.$dialog.confirm({title:"Transaction Submitted",message:e,cancelButtonText:"Confirm",confirmButtonText:"View Transanction"}).then((function(){window.open(n,"_blank")})).catch((function(){}))},changeTab:function(e,n){"Redeem"===n&&this.$router.push({name:"Redeem"})},getTokenImg:function(e){try{return t("e078")("./".concat(e,".png"))}catch(n){console.warn("can not find token image for ".concat(e))}return t("0d9c")},loadUserBalances:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var t,a,s,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e.user){n.next=21;break}t={},a=Object(r["a"])(e.supportedSwapTokens.concat(["bretUSD"])),n.prev=3,a.s();case 5:if((s=a.n()).done){n.next=12;break}return i=s.value,n.next=9,d["e"](window.web3,e.chainId,i,e.user["account"]);case 9:t[i]=n.sent;case 10:n.next=5;break;case 12:n.next=17;break;case 14:n.prev=14,n.t0=n["catch"](3),a.e(n.t0);case 17:return n.prev=17,a.f(),n.finish(17);case 20:e.userBalances=t;case 21:case"end":return n.stop()}}),n,null,[[3,14,17,20]])})))()},loadUserAllowances:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e.user){n.next=4;break}return n.next=3,d["d"](window.web3,e.chainId,e.supportedSwapTokens,e.user["account"],p["a"][e.chainId]["bretUSD"]["address"]);case 3:e.userAllowances=n.sent;case 4:case"end":return n.stop()}}),n)})))()}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$store.dispatch("initWeb3");case 3:n.next=8;break;case 5:n.prev=5,n.t0=n["catch"](0),e.$notify({type:"danger",message:n.t0.message});case 8:return n.next=10,m["c"](window.web3);case 10:e.supportedSwapTokens=n.sent,e.mintFromToken=e.supportedSwapTokens[0],e.supportedSwapTokenDetails=e.supportedSwapTokens.map((function(n){return{text:n,iconUrl:e.getTokenImg(n),value:n}})),e.loadUserBalances(),e.loadUserAllowances();case 15:case"end":return n.stop()}}),n,null,[[0,5]])})))()},mounted:function(){return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){}},g=v,b=t("2877"),w=Object(b["a"])(g,a,s,!1,null,"4df9d166",null);n["default"]=w.exports}}]);